<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>Logs</ion-title>
    <ion-buttons slot="primary">
      <ion-button (click)="showClearLogsAlert()">
        <ion-icon name="trash-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div
    *ngIf="!logData.length"
    class="h-100 d-flex align-items-center justify-content-center"
  >
    <div class="p-2 bg-danger rounded text-light">No logs found</div>
  </div>
  <ion-accordion-group
    *ngFor="let log of logData; let i=index;"
    class="m-2"
    value="0"
  >
    <ion-accordion [value]="i" class="rounded">
      <ion-item class="rounded" slot="header" [color]="getColor(log.operation)">
        <ion-label>
          <div class="d-flex">
            <div>{{log.operation}}</div>
            <div class="ms-auto">{{log.modifiedOn}}</div>
          </div>
        </ion-label>
      </ion-item>
      <div class="bgLight" slot="content">
        <div [ngSwitch]="log.operation" class="mx-2">
          <div *ngSwitchCase="'new'">
            <ion-grid>
              <ion-row>
                <ion-col size="5">Name</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col>{{log.data.name}}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="5">Principal</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.principal}}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col>Interest</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.interest}}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col>Start date</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.startDate}}</ion-col>
              </ion-row>
            </ion-grid>
          </div>

          <div
            *ngSwitchCase="log.operation==='edit' || log.operation==='edit - approve' ? log.operation: 'other'"
          >
            <ion-grid>
              <ion-row>
                <ion-col size="4">Name</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="7"> {{log.orgData.name}} </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="4">Principal</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="7">
                  {{log.orgData.principal}}
                  <span
                    *ngIf="log.orgData.principal !== log.newData.principal"
                    class="text-primary"
                  >
                    => {{log.newData.principal}}
                  </span>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="4">Interest</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="7">
                  {{log.orgData.interest}}
                  <span
                    *ngIf="log.orgData.interest !== log.newData.interest"
                    class="text-primary"
                  >
                    => {{log.newData.interest}}
                  </span>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="4">Start date</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="7"
                  >{{log.orgData.startDate}}
                  <span
                    *ngIf="log.orgData.startDate !== log.newData.startDate"
                    class="text-primary d-block text-end"
                  >
                    => {{log.newData.startDate}}</span
                  >
                </ion-col>
              </ion-row>
              <ion-row [hidden]="log.orgData.comments === log.newData.comments">
                <ion-col size="4">comments</ion-col>
                <ion-col size="1">:</ion-col>
              </ion-row>
              <ion-row [hidden]="log.orgData.comments === log.newData.comments">
                <ion-col size="" style="white-space: pre-line"
                  >{{log.orgData.comments}}
                  <span class="text-primary"
                    >=> {{'\n' + log.newData.comments}}</span
                  ></ion-col
                >
              </ion-row>
              <ion-row
                [hidden]="log.orgData.closedOn === log.newData.closedOn || !(log.orgData.closedOn || log.newData.closedOn)"
              >
                <ion-col size="4">closedOn</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="7"
                  >{{log.orgData.closedOn}}
                  <span class="text-primary text-end d-block"
                    >=> {{log.newData.closedOn}}</span
                  ></ion-col
                >
              </ion-row>
              <ion-row
                [hidden]="log.orgData.closedAmount === log.newData.closedAmount || !(log.orgData.closedAmount || log.newData.closedAmount)"
              >
                <ion-col size="4">closedAmt</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="7"
                  >{{log.orgData.closedAmount}} =>
                  {{log.newData.closedAmount}}</ion-col
                >
              </ion-row>
            </ion-grid>
          </div>
          <div *ngSwitchCase="'delete'">
            <ion-grid>
              <ion-row>
                <ion-col>Name</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.name}}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col>Principal</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.principal}}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col>Interest</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.interest}}</ion-col>
              </ion-row>
              <ion-row>
                <ion-col>Start date</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.startDate}}</ion-col>
              </ion-row>
              <ion-row [hidden]="!log.data.comments">
                <ion-col>comments</ion-col>
                <ion-col size="1">:</ion-col>
                <ion-col size="6">{{log.data.comments}}</ion-col>
              </ion-row>
            </ion-grid>
          </div>
        </div>
      </div>
    </ion-accordion>
  </ion-accordion-group>
</ion-content>
